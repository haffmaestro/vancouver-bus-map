<!DOCTYPE html>
<meta charset="utf-8">
<style>

#streets {
  fill: none;
  stroke: black;
  stroke-width: 1.5px;
  stroke-linejoin: round;
}

</style>
<svg></svg>
<script src="d3.js"></script>
<script src="d3-tile.js"></script>
<script src="d3-topo.js"></script>
<script>
  var pi = Math.PI,
  tau = 2 * pi;

  var svg = d3.select("svg"),
      width = window.innerWidth - 20,
      height = window.innerHeight - 20;

  svg.attr("width", width);
  svg.attr("height", height);

  var projection = d3.geoMercator()
    .scale((1 << 21) / tau)
    .translate([width / 2, height / 2])
    .center([-123.17, 49.26]);

  var path = d3.geoPath()
    .projection(projection);


  var tiles = d3.tile()
                .size([width, height])
                .scale(projection.scale() * tau)
                .translate(projection([0, 0]))();

  svg.selectAll("image")
    .data(tiles)
    .enter().append("image")
    .attr("xlink:href", function(d) { return "http://" + "abc"[d[1] % 3] + ".tile.openstreetmap.org/" + d[2] + "/" + d[0] + "/" + d[1] + ".png"; })
    .attr("x", function(d) { return (d[0] + tiles.translate[0]) * tiles.scale; })
    .attr("y", function(d) { return (d[1] + tiles.translate[1]) * tiles.scale; })
    .attr("width", tiles.scale)
    .attr("height", tiles.scale);
</script>
